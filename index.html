<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>EmiBonnie Memories Eternal</title>
    <style>
        :root {
            --emi: #f37021; --bonnie: #662d91;
            --grad: linear-gradient(135deg, #f37021, #662d91);
            --glass: rgba(255, 255, 255, 0.85);
            --glass-thick: rgba(255, 255, 255, 0.95);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; background: #fff; font-family: -apple-system, "PingFang TC", sans-serif; }
        
        /* è¦–è¦ºå“ç‰ŒèƒŒæ™¯ - ä½¿ç”¨å‰›ç”Ÿæˆçš„è¨­è¨ˆé¢¨æ ¼ */
        .bg-overlay { 
            position: fixed; 
            inset: 0; 
            background: 
                linear-gradient(rgba(255,255,255,0.4), rgba(255,255,255,0.4)),
                url('https://r.jina.ai/i/058e0a6e76834f3194a20a4422e11a3b'); /* é€™è£¡æœƒå‘ˆç¾ç”Ÿæˆçš„è´è¶æ„å¢ƒåœ– */
            background-repeat: no-repeat;
            background-position: center;
            background-size: cover;
            z-index: 0; 
        }

        /* é¦–é æ¨™é¡Œç¾åŒ– */
        .home-hero {
            position: fixed;
            top: 25%; /* åä¸Šæ–¹ */
            width: 100%;
            text-align: center;
            z-index: 1;
        }
        .main-title {
            font-size: 3.5rem;
            font-weight: 900;
            margin: 0;
            letter-spacing: 2px;
            background: var(--grad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }
        .stats-container {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 30px;
            background: rgba(255,255,255,0.5);
            backdrop-filter: blur(5px);
            padding: 20px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            border-radius: 30px;
        }

        .nav-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); z-index: 1000; width: 94%; max-width: 600px; }
        .main-nav { background: var(--glass); padding: 8px 12px; border-radius: 50px; backdrop-filter: blur(20px); box-shadow: 0 15px 35px rgba(0,0,0,0.1); display: flex; align-items: center; overflow-x: auto; border: 1px solid rgba(255,255,255,0.6); scrollbar-width: none; }
        .main-nav::-webkit-scrollbar { display: none; }
        .nav-logo-btn { font-size: 1.8rem; padding: 0 15px; border-right: 1.5px solid #eee; cursor: pointer; flex-shrink: 0; }
        .nav-btn { background: transparent; border: none; font-size: 0.9rem; font-weight: 700; color: #555; padding: 12px 15px; flex-shrink: 0; }
        .nav-btn.active-tab { color: var(--emi); }

        .modal { position: fixed; inset: 0; background: #fff; z-index: 500; transform: translateY(100%); transition: 0.5s cubic-bezier(0.2, 1, 0.3, 1); overflow-y: auto; padding-bottom: 120px; }
        .modal.active { transform: translateY(0); }
        .header { position: sticky; top: 0; background: rgba(255,255,255,0.95); padding: 20px 25px; display: flex; justify-content: space-between; align-items: center; z-index: 600; border-bottom: 1px solid #f0f0f0; }
        .m-title { font-size: 1.25rem; font-weight: 800; background: var(--grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .filter-bar { display: flex; gap: 10px; padding: 10px 20px; overflow-x: auto; scrollbar-width: none; }
        .filter-tab { padding: 6px 18px; border-radius: 20px; background: #f5f5f5; font-size: 0.85rem; font-weight: 600; color: #666; border: none; white-space: nowrap; }
        .filter-tab.active { background: var(--grad); color: #fff; }

        .adm-section { background: #fbfbfb; padding: 20px; border-radius: 25px; margin: 15px; border: 1px solid #eee; }
        .btn-main { background: var(--grad); color: #fff; border: none; padding: 14px; width: 100%; border-radius: 15px; font-weight: 800; cursor: pointer; margin-top: 10px; }
        input, select, textarea { width: 100%; padding: 12px; margin: 5px 0 10px; border-radius: 12px; border: 1px solid #ddd; font-size: 1rem; }

        .profile-card { text-align: center; padding: 40px 20px; }
        .profile-img { width: 120px; height: 120px; border-radius: 60px; object-fit: cover; border: 4px solid #fff; box-shadow: 0 10px 25px rgba(0,0,0,0.1); margin-bottom: 20px; }

        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .item-card { background: #fff; border-radius: 20px; border: 1px solid #f2f2f2; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .item-card img { width: 100%; height: 140px; object-fit: cover; background: #eee; }
        .item-info { padding: 12px; }
        .item-cat { font-size: 0.7rem; color: var(--emi); font-weight: 700; margin-bottom: 4px; display: block; }

        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 1px; background: #eee; margin: 0 15px; border-radius: 15px; overflow: hidden; }
        .cal-day { background: #fff; min-height: 80px; padding: 8px; font-size: 0.75rem; }
        .cal-ev { font-size: 0.6rem; padding: 2px 4px; border-radius: 4px; margin-top: 2px; background: var(--grad); color: #fff; }

        .manage-item { display: flex; align-items: center; justify-content: space-between; background: #fff; padding: 10px 15px; border-radius: 15px; margin-bottom: 8px; border: 1px solid #eee; }
        .manage-info { font-size: 0.85rem; color: #444; }
        .btn-del { background: #ff4d4d; color: #fff; border: none; padding: 5px 12px; border-radius: 10px; font-size: 0.75rem; font-weight: 700; }
        #day-pop { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #fff; width: 85%; z-index: 2000; padding: 25px; display: none; border-radius: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.15); }
    </style>
</head>
<body>

<div class="bg-overlay"></div>

<div class="home-hero">
    <h1 class="main-title">EmiBonnie</h1>
    <div class="stats-container">
        <div><span id="d1" style="font-size:2.2rem; font-weight:800; color:var(--emi)">0</span><div style="font-size:0.7rem; color:#666; font-weight:700;">è´è¶èª•ç”Ÿ</div></div>
        <div style="width:1px; background:#eee;"></div>
        <div><span id="d2" style="font-size:2.2rem; font-weight:800; color:var(--bonnie)">0</span><div style="font-size:0.7rem; color:#666; font-weight:700;">èˆ‡ä½ ç›¸é‡</div></div>
    </div>
</div>

<div class="nav-container">
    <nav class="main-nav">
        <div class="nav-logo-btn" onclick="closeAll()">ğŸ¦‹</div>
        <button class="nav-btn" onclick="openM('m-profile', this)">EmiBonnie</button>
        <button class="nav-btn" onclick="openM('m-timeline', this)">è»Œè·¡</button>
        <button class="nav-btn" onclick="openM('m-works', this)">ä½œå“</button>
        <button class="nav-btn" onclick="openM('m-plans', this)">è¡Œç¨‹</button>
        <button class="nav-btn" onclick="openM('m-coll', this)">æ”¶è—</button>
        <button class="nav-btn" onclick="openM('m-diary', this)">æ—¥è¨˜</button>
        <button class="nav-btn" onclick="openM('m-admin', this)" style="color:var(--emi)">ç®¡ç†</button>
    </nav>
</div>

<div id="m-works" class="modal">
    <div class="header"><span class="m-title">å®˜æ–¹ä½œå“</span><span onclick="closeAll()">âœ•</span></div>
    <div class="filter-bar">
        <button class="filter-tab active" onclick="filterWorks('all', this)">å…¨éƒ¨</button>
        <button class="filter-tab" onclick="filterWorks('movie', this)">å½±è¦–</button>
        <button class="filter-tab" onclick="filterWorks('show', this)">æ¼”å‡º</button>
        <button class="filter-tab" onclick="filterWorks('music', this)">éŸ³æ¨‚</button>
    </div>
    <div class="grid-2" id="w-render"></div>
</div>

<div id="m-profile" class="modal"><div class="header"><span class="m-title">EmiBonnie åç‰Œ</span><span onclick="closeAll()">âœ•</span></div><div id="p-render"></div></div>
<div id="m-timeline" class="modal"><div class="header"><span class="m-title">è´è¶è»Œè·¡</span><span onclick="closeAll()">âœ•</span></div><div id="tl-render" style="padding:20px;"></div></div>
<div id="m-plans" class="modal"><div class="header"><span class="m-title">è¡Œç¨‹æœˆæ›†</span><span onclick="closeAll()">âœ•</span></div><div style="display:flex;justify-content:space-between;padding:15px;"><span onclick="changeMonth(-1)">â—€</span><span id="cal-title"></span><span onclick="changeMonth(1)">â–¶</span></div><div class="cal-grid" id="cal-body"></div></div>
<div id="m-coll" class="modal"><div class="header"><span class="m-title">æ”¶è—é¤¨</span><span onclick="closeAll()">âœ•</span></div><div class="grid-2" id="coll-render"></div></div>
<div id="m-diary" class="modal"><div class="header"><span class="m-title">è´è¶æ—¥è¨˜</span><span onclick="closeAll()">âœ•</span></div><div id="diary-render" style="padding:20px;"></div></div>

<div id="m-admin" class="modal">
    <div class="header"><span class="m-title">ç®¡ç†ä¸­å¿ƒ</span><span onclick="closeAll()">âœ•</span></div>
    <div class="adm-section">
        <h4>âœï¸ æ–°å¢å›æ†¶å…§å®¹</h4>
        å…§å®¹é¡å‹ï¼š
        <select id="adm-type">
            <option value="tl">è»Œè·¡</option>
            <option value="work_movie">ä½œå“ - å½±è¦–</option>
            <option value="work_show">ä½œå“ - æ¼”å‡º</option>
            <option value="work_music">ä½œå“ - éŸ³æ¨‚</option>
            <option value="coll">æ”¶è—</option>
            <option value="diary">æ—¥è¨˜</option>
        </select>
        æ¨™é¡Œ/åç¨±ï¼š<input type="text" id="adm-name" placeholder="æ¨™é¡Œ">
        å…§å®¹æè¿°ï¼š<textarea id="adm-txt" rows="2" placeholder="è©³ç´°å…§å®¹..."></textarea>
        ä¸Šå‚³åœ–ç‰‡ï¼š<input type="file" id="adm-file" accept="image/*">
        <button class="btn-main" onclick="handleNew()">ç™¼å¸ƒå›æ†¶</button>
    </div>
    <div class="adm-section">
        <h4>ğŸ—‘ï¸ å…§å®¹ç®¡ç† (åˆªé™¤)</h4>
        <div id="adm-list-render"></div>
    </div>
    <div class="adm-section">
        <h4>ğŸ‘¤ åŸºæœ¬è³‡æ–™èˆ‡æ—¥æœŸ</h4>
        é—œéµæ—¥æœŸ(èª•ç”Ÿ)ï¼š<input type="date" id="adm-born">
        é—œéµæ—¥æœŸ(ç›¸é‡)ï¼š<input type="date" id="adm-meet">
        åç‰Œæš±ç¨±ï¼š<input type="text" id="adm-p-name">
        åç‰Œç°¡ä»‹ï¼š<textarea id="adm-p-bio"></textarea>
        åç‰Œé ­åƒï¼š<input type="file" id="adm-p-file" accept="image/*">
        <button class="btn-main" onclick="updateProfile()">æ›´æ–°åŸºæœ¬è³‡æ–™</button>
    </div>
</div>

<div id="day-pop"><b id="pop-date"></b><div id="pop-list" style="margin:15px 0;"></div><button class="btn-main" onclick="document.getElementById('day-pop').style.display='none'">é—œé–‰</button></div>

<script>
    // JS é‚è¼¯ä¿æŒåŸæœ¬å¼·å¤§çš„ LocalStorage ç³»çµ± (v3)
    let db = JSON.parse(localStorage.getItem('eb_mega_v3')) || {
        profile: { name: "EmiBonnie", bio: "è´è¶çš„æ•…äº‹å¾é€™è£¡é–‹å§‹...", img: "" },
        settings: { born: "2024-01-01", meet: "2024-01-01" },
        timeline: [], works: [], colls: [], diaries: [], plans: []
    };

    let curDate = new Date();
    const toBase64 = f => new Promise(r => { if(!f) {r("");return;} const rd=new FileReader(); rd.onload=e=>r(e.target.result); rd.readAsDataURL(f); });
    function save() { localStorage.setItem('eb_mega_v3', JSON.stringify(db)); renderHome(); }

    async function handleNew() {
        const typeRaw = document.getElementById('adm-type').value;
        const img = await toBase64(document.getElementById('adm-file').files[0]);
        const data = { id: Date.now(), n: document.getElementById('adm-name').value, t: document.getElementById('adm-txt').value, i: img, date: new Date().toLocaleString() };
        if(typeRaw.startsWith('work_')) { data.cat = typeRaw.split('_')[1]; db.works.unshift(data); } 
        else if(typeRaw === 'tl') db.timeline.unshift(data);
        else if(typeRaw === 'coll') db.colls.unshift(data);
        else if(typeRaw === 'diary') db.diaries.unshift(data);
        save(); renderManageList(); alert("ç™¼å¸ƒæˆåŠŸï¼");
    }

    function deleteItem(type, id) {
        if(!confirm("ç¢ºå®šè¦åˆªé™¤é€™æ¢å›æ†¶å—ï¼Ÿ")) return;
        db[type] = db[type].filter(i => i.id !== id);
        save(); renderManageList();
    }

    function renderManageList() {
        const container = document.getElementById('adm-list-render');
        const allItems = [
            ...db.timeline.map(i => ({...i, type: 'timeline', label: 'è»Œè·¡'})),
            ...db.works.map(i => ({...i, type: 'works', label: `ä½œå“(${i.cat})`})),
            ...db.colls.map(i => ({...i, type: 'colls', label: 'æ”¶è—'})),
            ...db.diaries.map(i => ({...i, type: 'diaries', label: 'æ—¥è¨˜'}))
        ].sort((a,b) => b.id - a.id);
        container.innerHTML = allItems.map(i => `<div class="manage-item"><div class="manage-info"><span style="color:var(--emi);font-weight:700;">[${i.label}]</span> ${i.n || i.t.substring(0,10)}</div><button class="btn-del" onclick="deleteItem('${i.type}', ${i.id})">åˆªé™¤</button></div>`).join('') || '<p style="text-align:center;color:#999;font-size:0.8rem;">ç›®å‰æ²’æœ‰å…§å®¹å¯ç®¡ç†</p>';
    }

    function filterWorks(cat, btn) {
        if(btn) { document.querySelectorAll('.filter-tab').forEach(b => b.classList.remove('active')); btn.classList.add('active'); }
        const container = document.getElementById('w-render');
        const list = cat === 'all' ? db.works : db.works.filter(w => w.cat === cat);
        const catMap = { movie: 'å½±è¦–', show: 'æ¼”å‡º', music: 'éŸ³æ¨‚' };
        container.innerHTML = list.map(w => `<div class="item-card"><img src="${w.i || 'https://via.placeholder.com/150'}"><div class="item-info"><span class="item-cat">${catMap[w.cat] || 'ä½œå“'}</span><b>${w.n}</b></div></div>`).join('');
    }

    function renderContent(id) {
        if(id==='m-profile') document.getElementById('p-render').innerHTML = `<div class="profile-card"><img src="${db.profile.img || 'https://via.placeholder.com/150'}" class="profile-img"><h2>${db.profile.name}</h2><p>${db.profile.bio}</p></div>`;
        if(id==='m-timeline') document.getElementById('tl-render').innerHTML = db.timeline.map(t => `<div style="margin-bottom:20px;border-left:2px solid var(--emi);padding-left:15px;"><b>${t.n}</b><p>${t.t}</p>${t.i?`<img src="${t.i}" style="width:100%;border-radius:10px;">`:''}</div>`).join('');
        if(id==='m-works') filterWorks('all', document.querySelector('.filter-tab'));
        if(id==='m-coll') document.getElementById('coll-render').innerHTML = db.colls.map(c => `<div class="item-card"><img src="${c.i}"><b>${c.n}</b></div>`).join('');
        if(id==='m-diary') document.getElementById('diary-render').innerHTML = db.diaries.map(d => `<div style="background:#f9f9f9;padding:15px;margin-bottom:15px;border-radius:15px;"><small>${d.date}</small><p>${d.t}</p>${d.i?`<img src="${d.i}" style="width:100%;">`:''}</div>`).join('');
        if(id==='m-plans') renderCal();
    }

    function openM(id, btn) { closeAll(); document.getElementById(id).classList.add('active'); if(btn) btn.classList.add('active-tab'); renderContent(id); if(id==='m-admin') { document.getElementById('adm-born').value = db.settings.born; document.getElementById('adm-meet').value = db.settings.meet; document.getElementById('adm-p-name').value = db.profile.name; document.getElementById('adm-p-bio').value = db.profile.bio; renderManageList(); } }
    function closeAll() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('active')); document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active-tab')); }
    function renderHome() {
        const calc = d => Math.floor((new Date() - new Date(d)) / 86400000);
        document.getElementById('d1').innerText = Math.max(0, calc(db.settings.born));
        document.getElementById('d2').innerText = Math.max(0, calc(db.settings.meet));
    }
    async function updateProfile() { db.settings.born = document.getElementById('adm-born').value; db.settings.meet = document.getElementById('adm-meet').value; db.profile.name = document.getElementById('adm-p-name').value; db.profile.bio = document.getElementById('adm-p-bio').value; const img = await toBase64(document.getElementById('adm-p-file').files[0]); if(img) db.profile.img = img; save(); alert("æ›´æ–°æˆåŠŸï¼"); }
    function renderCal() { const y = curDate.getFullYear(), m = curDate.getMonth(); document.getElementById('cal-title').innerText = `${y}å¹´ ${m+1}æœˆ`; const first = new Date(y, m, 1).getDay(), days = new Date(y, m+1, 0).getDate(); let h = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'].map(d => `<div style="text-align:center;padding:5px;font-size:0.6rem;color:#999;">${d}</div>`).join(''); for(let i=0; i<first; i++) h += `<div></div>`; for(let d=1; d<=days; d++) { const ds = `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`; const evs = db.plans.filter(p => p.date === ds); h += `<div class="cal-day" onclick="showPop('${ds}')"><b>${d}</b>${evs.map(e => `<div class="cal-ev">${e.txt}</div>`).join('')}</div>`; } document.getElementById('cal-body').innerHTML = h; }
    function showPop(d) { document.getElementById('pop-date').innerText = d; const evs = db.plans.filter(p => p.date === d); document.getElementById('pop-list').innerHTML = evs.map((e,i) => `<div style="display:flex;justify-content:space-between;padding:5px 0;"><span>${e.txt}</span><span style="color:red;" onclick="delPlan('${d}',${i})">åˆªé™¤</span></div>`).join('') || "ç„¡è¡Œç¨‹"; document.getElementById('day-pop').style.display='block'; }
    function delPlan(d, i) { db.plans = db.plans.filter((p,idx) => !(p.date===d && idx===i)); save(); renderCal(); showPop(d); }
    function changeMonth(s) { curDate.setMonth(curDate.getMonth()+s); renderCal(); }
    window.onload = renderHome;
</script>
</body>
</html>










